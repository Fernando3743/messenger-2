(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{26:function(e,t,s){},34:function(e,t,s){"use strict";s.r(t);var n=s(0),c=s.n(n),a=s(19),r=s.n(a),l=(s(26),s(21)),o=s(2),i=s(11),d=s.n(i),u=s(13),m=s(7),b=s(9),j=s(1);var h=function(){return Object(j.jsx)("div",{className:"hidden md:flex-1 md:grid place-items-center",children:Object(j.jsx)(b.a,{className:"h-60 text-gray-500"})})},x=s(8);var f=function(e){var t=e.user,s=e.sender,n=e.message;return Object(j.jsx)("div",{className:"max-w-2xl p-4 rounded-3xl my-3 ".concat(s.id===t.id?"ml-auto bg-blue-500":"mr-auto bg-gray-100"),children:Object(j.jsx)("p",{children:n})})};var p=function(e){var t=e.chatID,s=e.messages,c=e.user,a=e.user2,r=e.opened,l=e.fetchChats,o=e.setOpenedChat,i=Object(n.useRef)(null),d=Object(n.useState)(null),u=Object(m.a)(d,2),h=u[0],p=u[1];Object(n.useEffect)((function(){var e=new WebSocket("ws://"+window.location.host+"/ws/chat/"+t+"/");e.removeEventListener(onmessage,l),e.onmessage=l,p(e)}),[t]);var O=function(){h.send(JSON.stringify({message:i.current.value})),i.current.value=""};return Object(j.jsx)("div",{className:"flex-1 pr-4 ".concat(!r&&"hidden"),children:Object(j.jsxs)("div",{className:"flex flex-col h-screen relative",children:[Object(j.jsxs)("div",{className:"flex items-center p-2 h-20 bg-white",children:[Object(j.jsx)(x.a,{onClick:function(){return o({})},className:"blueIcon ml-3"}),Object(j.jsxs)("h1",{className:"mx-auto font-bold text-2xl",children:[a.email,"'s chat"]}),Object(j.jsxs)("div",{className:"flex items-center space-x-2",children:[Object(j.jsx)(x.f,{className:"blueIcon"}),Object(j.jsx)(x.h,{className:"blueIcon"}),Object(j.jsx)(b.b,{className:"blueIcon"})]})]}),Object(j.jsx)("div",{className:"flex-1 flex flex-col-reverse overflow-y-scroll scrollbar-hide",children:s.length>0&&s.map((function(e){return Object(j.jsx)(f,{user:c,sender:e.user,message:e.message},e.id)}))}),Object(j.jsxs)("div",{className:"flex h-16 items-center space-x-3 px-2",children:[Object(j.jsxs)("div",{className:"flex-1 flex items-center bg-gray-100 h-12 rounded-3xl px-3",children:[Object(j.jsx)("input",{className:"outline-none bg-transparent flex-1",type:"text",ref:i,onKeyDown:function(e){13===e.keyCode&&O()},placeholder:"Type your message here"}),Object(j.jsx)(x.c,{onClick:O,className:"blueIcon"})]}),Object(j.jsxs)("div",{className:"flex space-x-2",children:[Object(j.jsx)(x.b,{className:"blueIcon"}),Object(j.jsx)(x.g,{className:"blueIcon"}),Object(j.jsx)(x.e,{className:"blueIcon"}),Object(j.jsx)(x.d,{className:"blueIcon"})]})]})]})})};function O(e){var t=null;if(document.cookie&&""!==document.cookie)for(var s=document.cookie.split(";"),n=0;n<s.length;n++){var c=s[n].trim();if(c.substring(0,e.length+1)===e+"="){t=decodeURIComponent(c.substring(e.length+1));break}}return t}var g=function(e){var t=e.username,s=e.image,n=e.message,c=e.id,a=e.openChat;return Object(j.jsxs)("div",{onClick:function(){return a(c)},className:"flex items-center space-x-3 p-1 my-4 transform transition duration-500 ease-in-out hover:scale-105 cursor-pointer",children:[Object(j.jsx)("img",{className:"h-16 w-16 rounded-full object-cover",src:s,alt:"Profile Pic"}),Object(j.jsxs)("div",{className:"truncate overflow-hidden",children:[Object(j.jsx)("h1",{className:"font-bold text-xl",children:t}),Object(j.jsx)("p",{className:"text-lg text-gray-500 truncate",children:n})]})]})};var v=function(e){var t=e.chats,s=e.user,n=e.openChat,c=e.openedChat,a=e.fetchChats,r=function(){var e=Object(u.a)(d.a.mark((function e(){var t,s,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=prompt("Write user's username you wanna chat with"),s=O("csrftoken"),n=new Request("/new_chat",{headers:{"X-CSRFToken":s}}),e.next=5,fetch(n,{method:"POST",body:JSON.stringify({username:t})}).then((function(e){return e.json()})).then((function(e){e.error?alert(e.error):(console.log(e.message),a())}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(j.jsxs)("div",{className:"px-4 ".concat(c?"hidden":"flex"," md:flex flex-col w-full md:max-w-[400px] lg:min-w-[500px] h-screen"),children:[Object(j.jsxs)("div",{className:"flex justify-between p-2 rounded-b-2xl h-20 items-center",children:[Object(j.jsx)("a",{href:"/logout",children:Object(j.jsx)("img",{src:s.image,alt:"User's profile",className:"h-14 w-14 rounded-full object-cover"})}),Object(j.jsx)("h1",{className:"font-bold text-2xl",children:"Messages"}),Object(j.jsx)(b.c,{onClick:r,className:"blueIcon"})]}),Object(j.jsxs)("div",{className:"flex items-center mt-2 p-2 h-15 shadow-lg rounded-xl w-full space-x-2",children:[Object(j.jsx)(b.d,{className:"h-6 text-gray-400"}),Object(j.jsx)("input",{placeholder:"Search Messages",type:"text",className:"h-8 w-full outline-none text-lg"})]}),Object(j.jsx)("div",{className:"flex-1 overflow-y-scroll scrollbar-hide",children:t.map((function(e){var t,c=e.user1.id===s.id?e.user2:e.user1,a=c.username,r=c.image,l=c.id,o=(null===(t=e.messages[0])||void 0===t?void 0:t.message)||null;return Object(j.jsx)(g,{id:l,username:a,image:r,message:o,openChat:n},l)}))})]})};var w=function(){var e=Object(n.useState)({}),t=Object(m.a)(e,2),s=t[0],c=t[1],a=Object(n.useState)({}),r=Object(m.a)(a,2),l=r[0],o=r[1],i=Object(n.useState)([]),b=Object(m.a)(i,2),x=b[0],f=b[1],O=Object(n.useState)({}),g=Object(m.a)(O,2),w=g[0],N=g[1];Object(n.useEffect)((function(){fetch("/user").then((function(e){return e.json()})).then((function(e){c(e)})),fetch("/chats").then((function(e){return e.json()})).then((function(e){f(e)}))}),[]);var y=function(){var e=Object(u.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fetch("/chats").then((function(e){return e.json()})).then((function(e){f(e)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(j.jsxs)("div",{className:"flex",children:[Object(j.jsx)(v,{fetchChats:y,openedChat:Boolean(Object.keys(w).length),user:s,chats:x,openChat:function(e){var t={};N(t);for(var n=0;n<x.length;n++)if(x[n].user1.id===e||x[n].user2.id===e){t=x[n];break}var c=t.user1.id===s.id?t.user2:t.user1;o(c),N(t)}}),Object.keys(w).length?x.map((function(e){var t=w.id===e.id;return Object(j.jsx)(p,{setOpenedChat:N,fetchChats:y,opened:t,chatID:e.id,user:s,user2:l,messages:e.messages})})):Object(j.jsx)(h,{})]})},N=s.p+"static/media/messenger.54e2c7f7.png";var y=function(){var e=Object(o.f)(),t=Object(n.useState)(""),s=Object(m.a)(t,2),c=s[0],a=s[1],r=Object(n.useRef)(null),l=Object(n.useRef)(null);return Object(j.jsxs)("div",{className:"flex",children:[Object(j.jsx)("div",{className:"hidden md:grid w-2/5 h-screen place-items-center",children:Object(j.jsx)("img",{className:"h-80 w-80",src:N,alt:"Messenger Logo"})}),Object(j.jsx)("div",{className:"w-full md:w-1/2 h-screen flex items-center p-5 md:p-20",children:Object(j.jsx)("div",{className:"w-full",children:Object(j.jsxs)("form",{className:"bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4",method:"post",action:"/login",onSubmit:function(t){t.preventDefault();var s=O("csrftoken"),n=new Request("/login",{headers:{"X-CSRFToken":s}});fetch(n,{method:"POST",body:JSON.stringify({username:r.current.value,password:l.current.value})}).then((function(t){if(!t.redirected)return t.json();e.push("/")})).then((function(e){e&&(a(e.message),r.current.value="",l.current.value="")}))},children:[Object(j.jsx)("p",{className:"text-red-500 text-xs md:text-base italic",children:c}),Object(j.jsxs)("div",{className:"mb-4",children:[Object(j.jsx)("label",{className:"block text-gray-700 text-sm md:text-lg font-bold mb-2",htmlFor:"username",children:"Username"}),Object(j.jsx)("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",autoFocus:!0,id:"username",ref:r,type:"text",placeholder:"Username"})]}),Object(j.jsxs)("div",{className:"mb-6",children:[Object(j.jsx)("label",{className:"block text-gray-700 text-sm md:text-lg font-bold mb-2",htmlFor:"password",children:"Password"}),Object(j.jsx)("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline",id:"password",type:"password",ref:l,placeholder:"******************"})]}),Object(j.jsxs)("div",{className:"flex items-center justify-between",children:[Object(j.jsx)("input",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",type:"submit",value:"Sign In"}),Object(j.jsx)("a",{className:"inline-block align-baseline font-bold text-sm text-blue-500 hover:text-blue-800",href:"/register",children:"Sign Up"})]})]})})})]})};var k=function(){var e=Object(o.f)(),t=Object(n.useState)(""),s=Object(m.a)(t,2),c=s[0],a=s[1],r=Object(n.useRef)(null),l=Object(n.useRef)(null),i=Object(n.useRef)(null),d=Object(n.useRef)(null),u=Object(n.useRef)(null);return Object(j.jsx)("div",{children:Object(j.jsxs)("div",{className:"flex",children:[Object(j.jsx)("div",{className:"hidden md:grid w-2/5 h-screen place-items-center",children:Object(j.jsx)("img",{className:"h-80 w-80",src:N,alt:"Messenger Logo"})}),Object(j.jsx)("div",{className:"w-full md:w-1/2 h-screen flex items-center p-5 md:p-20",children:Object(j.jsx)("div",{className:"w-full",children:Object(j.jsxs)("form",{className:"bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4",onSubmit:function(t){t.preventDefault();var s=O("csrftoken"),n=new Request("/register",{headers:{"X-CSRFToken":s}});fetch(n,{method:"POST",body:JSON.stringify({username:r.current.value,email:l.current.value,image:i.current.value,password:d.current.value,confirmation:u.current.value})}).then((function(t){if(!t.redirected)return t.json();e.push("/")})).then((function(e){e.message&&a(e.message),r.current.value="",l.current.value="",d.current.value="",u.current.value=""}))},children:[Object(j.jsx)("p",{className:"text-red-500 text-xs md:text-base italic",children:c}),Object(j.jsxs)("div",{className:"mb-4",children:[Object(j.jsx)("label",{className:"block text-gray-700 text-sm md:text-lg font-bold mb-2",htmlFor:"username",children:"Username"}),Object(j.jsx)("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",autoFocus:!0,id:"username",ref:r,type:"text",placeholder:"Username"})]}),Object(j.jsxs)("div",{className:"mb-4",children:[Object(j.jsx)("label",{className:"block text-gray-700 text-sm md:text-lg font-bold mb-2",htmlFor:"email",children:"Email Address"}),Object(j.jsx)("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"email",ref:l,type:"email",placeholder:"Email Address"})]}),Object(j.jsxs)("div",{className:"mb-4",children:[Object(j.jsx)("label",{className:"block text-gray-700 text-sm md:text-lg font-bold mb-2",htmlFor:"imageUrl",children:"Image Url"}),Object(j.jsx)("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"imageUrl",ref:i,type:"text",placeholder:"Image Url"})]}),Object(j.jsxs)("div",{className:"mb-4",children:[Object(j.jsx)("label",{className:"block text-gray-700 text-sm md:text-lg font-bold mb-2",htmlFor:"password",children:"Password"}),Object(j.jsx)("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"password",ref:d,type:"password",placeholder:"******************"})]}),Object(j.jsxs)("div",{className:"mb-6",children:[Object(j.jsx)("label",{className:"block text-gray-700 text-sm md:text-lg font-bold mb-2",htmlFor:"confirmation",children:"Confirm Password"}),Object(j.jsx)("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline",id:"confirmation",type:"password",ref:u,placeholder:"******************"})]}),Object(j.jsxs)("div",{className:"flex items-center justify-between",children:[Object(j.jsx)("input",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",type:"submit",value:"Sign Up"}),Object(j.jsxs)("div",{children:["Already have an account? ","   ",Object(j.jsx)("a",{className:"inline-block align-baseline font-bold text-sm text-blue-500 hover:text-blue-800",href:"/login",children:"Sign In"})]})]})]})})})]})})};var S=function(){return Object(j.jsx)(l.a,{children:Object(j.jsxs)(o.c,{children:[Object(j.jsx)(o.a,{exact:!0,path:"/",component:w}),Object(j.jsx)(o.a,{exact:!0,path:"/login",component:y}),Object(j.jsx)(o.a,{exact:!0,path:"/register",component:k})]})})};r.a.render(Object(j.jsx)(c.a.StrictMode,{children:Object(j.jsx)(S,{})}),document.getElementById("root"))}},[[34,1,2]]]);
//# sourceMappingURL=main.328e3d98.chunk.js.map